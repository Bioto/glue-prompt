version: '3.8'

services:
  glueprompt-server:
    build: .
    ports:
      - "8000:8000"
    environment:
      - GLUEPROMPT_LOG_LEVEL=${GLUEPROMPT_LOG_LEVEL:-INFO}
      - GLUEPROMPT_DEFAULT_PROMPTS_PATH=${GLUEPROMPT_DEFAULT_PROMPTS_PATH:-./prompts}
      - GLUEPROMPT_CACHE_ENABLED=${GLUEPROMPT_CACHE_ENABLED:-true}
      - GLUEPROMPT_CACHE_TTL_SECONDS=${GLUEPROMPT_CACHE_TTL_SECONDS:-300}
    volumes:
      # Mount cache and config directories for persistence
      - glueprompt-cache:/root/.cache/glueprompt
      - glueprompt-config:/root/.config/glueprompt
      # Optionally mount local prompts directory
      # - ./prompts:/app/prompts:ro
    restart: unless-stopped
    # Override command as needed
    # command: ["glueprompt", "serve", "--host", "0.0.0.0", "--port", "8000", "--reload"]

volumes:
  glueprompt-cache:
  glueprompt-config:
